"0","segments <- function(from, to, rep = FALSE) {"
"0","  options(warn = 1)"
"0","  "
"0","  validateValue <- function(name, value) {"
"0","    if (any(value > 1)) {"
"0","      value[value > 1] = 1"
"0","      warning(paste0("" '"", name, ""' value(s) larger than 1 reduced to 1 \n""))"
"0","    }"
"0","  "
"0","    if (any(value < -1)) {"
"0","      value[value < -1] = -1"
"0","      warning(paste0("" '"", name, ""' value(s) less than -1 raised to -1 \n""))"
"0","    }"
"0","    "
"0","    value"
"0","  }"
"0","  "
"0","  if (length(from) > 1 & length(to) == 1) {"
"0","    from <- sort(from, decreasing = FALSE)"
"0","    to <- rep(to, length(from))"
"0","  }"
"0","  "
"0","  if (length(to) > 1 & length(from) == 1) {"
"0","    to <- sort(to, decreasing = FALSE)"
"0","    from <- rep(from, length(to))"
"0","  }"
"0","  "
"0","  if (length(from) == length(to)) {"
"0","    rowBind <- rbind(from, to)"
"0","    vector <- c(rowBind)"
"0","    matrix <- matrix(vector, ncol = length(from))"
"0","    dimnames(matrix) <- list(c('from', 'to'))"
"0","    matrix <- t(matrix)"
"0","    matrix[, ""from""] <- validateValue(""from"", matrix[, ""from""])"
"0","    matrix[, ""to""] <- validateValue(""to"", matrix[, ""to""])"
"0","    matrix"
"0","  }"
"0","  "
"0","}"
"0","segments(4:1/10, .9)"
"1","    "
"1"," from"
"1","  to"
"1","
[1,]"
"1","  0.1"
"1"," 0.9"
"1","
[2,]"
"1","  0.2"
"1"," 0.9"
"1","
[3,]"
"1","  0.3"
"1"," 0.9"
"1","
[4,]"
"1","  0.4"
"1"," 0.9"
"1","
"
